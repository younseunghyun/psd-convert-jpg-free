# PSD Convert Free (가칭) - 기획서 / PRD

## 1. 한줄 요약
사용자가 **PSD 파일을 업로드 없이(브라우저에서만)** 열어 미리보기하고, **PNG/JPG로 빠르게 변환**해 내려받을 수 있는 웹 앱.

## 2. 목표(Goals)
- **순수 브라우저 동작**: 서버 업로드/처리 없이 로컬 파일만으로 변환.
- **빠른 체감 속도**: “드래그 앤 드롭 -> 즉시 미리보기 -> 1~2클릭으로 저장” 흐름.
- **대용량 대응**: 가능한 한 큰 PSD도 UI가 멈추지 않도록(Worker/스트리밍/점진 처리).
- **프라이버시**: 외부 전송 없음(네트워크 호출 최소/선택적).

## 3. 비목표(Non-goals, 초기 범위 밖)
- 포토샵 수준의 완전한 렌더링(모든 블렌딩/효과/스마트 오브젝트/텍스트 렌더).
- PSD 편집 기능(레이어 편집, 텍스트 수정 등).
- 클라우드 저장/공유(로그인, 서버 저장소).

## 4. 타겟 사용자
- PSD를 “열어보기만” 하거나 “빠르게 이미지로 변환”하려는 사용자
  - 디자이너가 아닌 PM/개발자/마케터
  - 외부 툴 설치가 어려운 환경(회사 PC, 크롬북 등)
- 프라이버시가 중요한 사용자(업로드 금지 환경)

## 5. 핵심 사용자 시나리오(User Stories)
1. 사용자는 PSD를 드래그해서 올리면 즉시 미리보기를 보고 싶다.
2. 사용자는 PNG로 원본 품질로 내보내고 싶다(투명 유지).
3. 사용자는 JPG로 용량을 줄여 내보내고 싶다(품질/배경색 선택).
4. 사용자는 여러 파일을 연속으로 변환하고 싶다(최근 변환 히스토리).
5. 사용자는 “이 PSD는 완전 렌더링이 어려움” 같은 제한을 명확히 알고 싶다.

## 6. MVP 범위(1차)
### 6.1 지원 포맷/입출력
- 입력: `.psd` (단일 파일)
- 출력:
  - `PNG` (투명 지원)
  - `JPG` (품질 슬라이더 0.1~1.0, 배경색 선택: 흰/검/사용자 지정)

### 6.2 렌더링 전략(MVP)
성능/정확도 트레이드오프를 명확히 한다.
- 1순위(가장 빠름): PSD 내부의 **merged/composite 이미지**가 존재하면 이를 사용해 미리보기/변환
- 2순위(확장): composite이 없거나 불완전하면 “제한 모드”로 안내하고 가능 범위 내에서 렌더링 시도
  - MVP에서는 우선 “지원 제한” 메시지 + 원인(예: composite 없음, 미지원 레이어 효과 등)을 노출

### 6.3 UX 기능
- 드래그 앤 드롭 + 파일 선택 버튼
- 변환 옵션 패널(PNG/JPG, 품질, 배경색, 출력 크기)
- 미리보기(확대/축소, 픽셀 크기 표시)
- 다운로드 버튼(파일명 규칙 포함)
- 에러/제한 안내(왜 안 되는지, 해결 팁)

### 6.4 구현 선택(확정)
- 프론트엔드: React
- 렌더링: composite(병합) 이미지 기반(레이어 합성은 2차)

## 7. 2차(확장) 범위
- 다중 파일 변환(큐/일괄 다운로드 zip은 브라우저 내 zip 생성으로)
- 기본 레이어 합성(일부 블렌드 모드/불투명도/마스크)
- 출력 크기 프리셋(1x, 0.5x, 가로/세로 제한, 리사이즈 필터 선택)
- PWA(오프라인 사용)
- i18n(ko/en)

## 8. 성능 목표(체감 지표)
환경 가정: 최신 크롬/엣지/사파리, 일반 노트북.
- 첫 미리보기 표시(TTV): 작은 PSD(<=50MB) 기준 **2초 이내**
- UI 프리즈 방지: 파싱/디코딩은 **Web Worker**로 보내고 메인 스레드 프레임 드랍 최소화
- 메모리: 가능한 한 `ArrayBuffer` 복사 최소(Transferable 사용)

## 9. 기술 설계(브라우저 전용)
### 9.1 아키텍처 개요
- UI(main thread): 파일 입력, 옵션 설정, 진행률 표시, 미리보기 렌더링(가능하면 `OffscreenCanvas`)
- Worker:
  - PSD 파싱(헤더/리소스/레이어/merged 이미지)
  - 디코딩(RLE 등)
  - 결과로 `ImageBitmap` 또는 RGBA 버퍼 전달(Transferable)

### 9.2 렌더/내보내기 파이프라인
1. PSD 파일을 `ArrayBuffer`로 읽고 Worker로 transfer
2. Worker에서 composite 추출/디코딩
3. 메인에서 `ImageBitmap`을 `canvas`에 draw
4. 내보내기:
   - PNG: `canvas.toBlob('image/png')`
   - JPG: 배경색 fill 후 `canvas.toBlob('image/jpeg', quality)`

### 9.3 호환성 이슈/대응
- iOS Safari:
  - `OffscreenCanvas`/Worker 캔버스 제약 가능: 폴백 경로 필요
- File System Access API:
  - 미지원 브라우저에서는 일반 다운로드 링크 방식으로 폴백

### 9.4 라이브러리 후보(조사/선정 필요)
- PSD 파서(JS): 예) `ag-psd` 등
- (추후) WASM 기반 PSD 디코더/렌더러: 정확도/성능 검토 필요

## 10. 제품 요구사항(PRD 상세)
### 10.1 화면 구성
- Landing / Converter 단일 페이지
  - 상단: 로고/짧은 설명(“업로드 없음, 브라우저에서만”)
  - 중앙: Dropzone + 파일 선택
  - 우측/하단: 옵션 패널
  - 하단: 미리보기(캔버스) + 메타데이터(가로/세로, 컬러모드 등)

### 10.2 옵션
- 포맷: PNG / JPG
- JPG 품질: 슬라이더(기본 0.9)
- JPG 배경: 화이트(기본) / 블랙 / 커스텀 컬러
- 출력 크기:
  - 원본
  - 배율(0.25, 0.5, 1, 2)
  - 최대 변 길이(px) 제한(선택)

### 10.3 파일명 규칙
- 기본: `{원본명}-{WxH}.{ext}`
- 사용자가 접미사 커스터마이즈 가능(2차)

### 10.4 오류/제한 메시지(필수)
- 파일이 PSD가 아님
- 파싱 실패(손상 파일/암호화/미지원 버전)
- composite 없음 또는 미지원 기능으로 렌더 불가
- 메모리 부족/브라우저 제한(해결 팁: 탭 닫기, 낮은 해상도 출력 등)

## 11. 보안/프라이버시
- 기본 정책: 네트워크 요청 없음(폰트/CDN 포함)
- 분석 도구는 기본 제외. 넣는다면 opt-in + 로컬/익명 처리 우선.
- 로컬 처리 명시(FAQ/문구로 신뢰 강화)

## 12. 성공 지표(Success Metrics)
- 변환 성공률(지원 범위 내)
- 평균 변환 시간, 95퍼센타일 변환 시간
- 이탈 지점: 파일 선택 후 실패/대기 중 이탈
- 재방문(로컬 도구 대체로 반복 사용 가능)

## 13. 리스크/오픈 이슈
- PSD 렌더링 정확도: composite 의존 시 일부 파일에서 결과가 기대와 다를 수 있음
- 브라우저 메모리 제한: 대형 PSD에서 OOM 가능
- iOS/사파리 Worker/캔버스 제약
- 레이어 합성 범위 확장 시 구현 복잡도 급증

## 14. 개발 마일스톤(제안)
1. (MVP) 파일 입력, Worker 파싱, composite 미리보기, PNG/JPG 다운로드
2. 에러/제한 UX 강화, 성능 튜닝(Transferable/OffscreenCanvas/점진 UI)
3. 다중 파일 큐 + 히스토리
4. (선택) 기본 레이어 렌더링 확대, PWA
